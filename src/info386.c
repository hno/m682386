/* info386
** ger information om flaggp†verkning f”r 386 instruktioner
*/

#include <stddef.h>

#include "info386.h"

static INFO86 table[]={
/*  instr	instrcode			 set		 used		 preserv	 opmode	*/
	{"AAA"	,INSTR86_AAA		,F_C		,F_C		,F_NONE	,O_NONE},
	{"AAD"	,INSTR86_AAD},
	{"AAM"	,INSTR86_AAM},
	{"AAS"	,INSTR86_AAS		,F_C		,F_C		,F_NONE	,O_NONE},
	{"ADC"	,INSTR86_ADC		,F_ALL	,F_C		,F_NONE	,O_MDST},
	{"ADD"	,INSTR86_ADD		,F_ALL	,F_NONE	,F_NONE	,O_MDST},
	{"AND"	,INSTR86_AND		,F_ALL	,F_NONE	,F_NONE	,O_MDST},
	{"ARPL"	,INSTR86_ARPL},
	{"BOUND"	,INSTR86_BOUND},
	{"BSF"	,INSTR86_BSF},
	{"BSR"	,INSTR86_BSR},
	{"BT"		,INSTR86_BT			,F_C		,F_NONE	,F_NONE	,O_CHECK},
	{"BTC"	,INSTR86_BTC		,F_C		,F_NONE	,F_NONE	,O_MDST},
	{"BTR"	,INSTR86_BTR		,F_C		,F_NONE	,F_NONE	,O_MDST},
	{"BTS"	,INSTR86_BTS		,F_C		,F_NONE	,F_NONE	,O_MDST},
	{"CALL"	,INSTR86_CALL		,F_SUBSET,F_SUBUSE,F_SUBPRE,O_FLOW},
	{"CBW"	,INSTR86_CBW},
	{"CWDE"	,INSTR86_CWDE},
	{"CLC"	,INSTR86_CLC		,F_C		,F_NONE	,F_ALL	,O_NONE},
	{"CLD"	,INSTR86_CLD},
	{"CLI"	,INSTR86_CLI},
	{"CLTS"	,INSTR86_CLTS},
	{"CMC"	,INSTR86_CMC},
	{"CMP"	,INSTR86_CMP		,F_ALL	,F_NONE	,F_NONE	,O_CHECK},
	{"CMPS"	,INSTR86_CMPS},
	{"CMPSB"	,INSTR86_CMPSB},
	{"CMPSW"	,INSTR86_CMPSW},
	{"CMPSD"	,INSTR86_CMPSD},
	{"CWD"	,INSTR86_CWD},
	{"CDW"	,INSTR86_CDQ},
	{"DAA"	,INSTR86_DAA},
	{"DAS"	,INSTR86_DAS},
	{"DEC"	,INSTR86_DEC},
	{"DIV"	,INSTR86_DIV		,F_NONE	,F_NONE	,F_NONE	,O_MDST},
	{"ENTER"	,INSTR86_ENTER},
	{"HLT"	,INSTR86_HLT},
	{"IDIV"	,INSTR86_IDIV		,F_NONE	,F_NONE	,F_NONE	,O_MDST},
	{"IMUL"	,INSTR86_IMUL		,F_NONE	,F_NONE	,F_NONE	,O_MDST},
	{"IN"		,INSTR86_IN},
	{"INC"	,INSTR86_INC},
	{"INS"	,INSTR86_INS},
	{"INSB"	,INSTR86_INSB},
	{"INSW"	,INSTR86_INSW},
	{"INSD"	,INSTR86_INSD},
	{"INT"	,INSTR86_INT},
	{"INTO"	,INSTR86_INTO},
	{"IRET"	,INSTR86_IRET},
	{"IRETD"	,INSTR86_IRETD},
	{"JA"		,INSTR86_JA			,F_NONE	,F_HI		,F_ALL	,O_FLOW},
	{"JAE"	,INSTR86_JAE},
	{"JB"		,INSTR86_JB},
	{"JBE"	,INSTR86_JBE		,F_NONE	,F_LS		,F_ALL	,O_FLOW},
	{"JC"		,INSTR86_JC			,F_NONE	,F_CS		,F_ALL	,O_FLOW},
	{"JCXZ"	,INSTR86_JCXZ},
	{"JECXZ"	,INSTR86_JECXZ},
	{"JE"		,INSTR86_JE			,F_NONE	,F_EQ		,F_ALL	,O_FLOW},
	{"JG"		,INSTR86_JG			,F_NONE	,F_GT		,F_ALL	,O_FLOW},
	{"JGE"	,INSTR86_JGE		,F_NONE	,F_GE		,F_ALL	,O_FLOW},
	{"JL"		,INSTR86_JL			,F_NONE	,F_LT		,F_ALL	,O_FLOW},
	{"JLE"	,INSTR86_JLE		,F_NONE	,F_LE		,F_ALL	,O_FLOW},
	{"JNA"	,INSTR86_JNA},
	{"JNAE"	,INSTR86_JNAE},
	{"JNB"	,INSTR86_JNB},
	{"JNBE"	,INSTR86_JNBE},
	{"JNC"	,INSTR86_JNC		,F_NONE	,F_CC		,F_ALL	,O_FLOW},
	{"JNE"	,INSTR86_JNE		,F_NONE	,F_NE		,F_ALL	,O_FLOW},
	{"JNG"	,INSTR86_JNG},
	{"JNGE"	,INSTR86_JNGE},
	{"JNL"	,INSTR86_JNL},
	{"JNLE"	,INSTR86_JNLE},
	{"JNO"	,INSTR86_JNO		,F_NONE	,F_VC		,F_ALL	,O_FLOW},
	{"JNP"	,INSTR86_JNP},
	{"JNS"	,INSTR86_JNS		,F_NONE	,F_PL		,F_ALL	,O_FLOW},
	{"JNZ"	,INSTR86_JNZ},
	{"JO"		,INSTR86_JO			,F_NONE	,F_VS		,F_ALL	,O_FLOW},
	{"JP"		,INSTR86_JP},
	{"JPE"	,INSTR86_JPE},
	{"JPO"	,INSTR86_JPO},
	{"JS"		,INSTR86_JS			,F_NONE	,F_MI		,F_ALL	,O_FLOW},
	{"JZ"		,INSTR86_JZ},
	{"JMP"	,INSTR86_JMP		,F_NONE	,F_NONE	,F_ALL	,O_FLOW},
	{"LAHF"	,INSTR86_LAHF},
	{"LAR"	,INSTR86_LAR},
	{"LEA"	,INSTR86_LEA		,F_NONE	,F_NONE	,F_ALL	,O_NORMAL},
	{"LEAVE"	,INSTR86_LEAVE},
	{"LGDT"	,INSTR86_LGDT},
	{"LIDT"	,INSTR86_LIDT},
	{"LGS"	,INSTR86_LGS},
	{"LSS"	,INSTR86_LSS},
	{"LDS"	,INSTR86_LDS},
	{"LES"	,INSTR86_LES},
	{"LFS"	,INSTR86_LFS},
	{"LLDT"	,INSTR86_LLDT},
	{"LMSW"	,INSTR86_LMSW},
	{"LOCK"	,INSTR86_LOCK},
	{"LODS"	,INSTR86_LODS},
	{"LODSB"	,INSTR86_LODSB},
	{"LODSW"	,INSTR86_LODSW},
	{"LODSD"	,INSTR86_LODSD},
	{"LOOP"	,INSTR86_LOOP},
	{"LOOPE"	,INSTR86_LOOPE},
	{"LOOPZ"	,INSTR86_LOOPZ},
	{"LOOPNE",INSTR86_LOOPNE},
	{"LOOPNZ",INSTR86_LOOPNZ},
	{"LSL"	,INSTR86_LSL},
	{"LTR"	,INSTR86_LTR},
	{"MOV"	,INSTR86_MOV		,F_NONE	,F_NONE	,F_ALL	,O_NORMAL},
	{"MOVS"	,INSTR86_MOVS},
	{"MOVSB"	,INSTR86_MOVSB},
	{"MOVSW"	,INSTR86_MOVSW},
	{"MOVSD"	,INSTR86_MOVSD},
	{"MOVSX"	,INSTR86_MOVSX		,F_NONE	,F_NONE	,F_ALL	,O_NORMAL},
	{"MOVZX"	,INSTR86_MOVZX},
	{"MUL"	,INSTR86_MUL		,F_N|F_Z	,F_NONE	,F_NONE	,O_MDST},
	{"NEG"	,INSTR86_NEG		,F_C		,F_NONE	,F_NONE	,O_MOD},
	{"NOP"	,INSTR86_NOP		,F_NONE	,F_NONE	,F_ALL	,O_NONE},
	{"NOT"	,INSTR86_NOT		,F_NONE	,F_NONE	,F_ALL	,O_MOD},
	{"OR"		,INSTR86_OR			,F_ALL	,F_NONE	,F_NONE	,O_NORMAL},
	{"OUT"	,INSTR86_OUT},
	{"OUTS"	,INSTR86_OUTS},
	{"OUTSB"	,INSTR86_OUTSB},
	{"OUTSW"	,INSTR86_OUTSW},
	{"OUTSD"	,INSTR86_OUTSD},
	{"POP"	,INSTR86_POP		,F_NONE	,F_NONE	,F_ALL	,O_DST},
	{"POPA"	,INSTR86_POPA},
	{"POPAD"	,INSTR86_POPAD},
	{"POPF"	,INSTR86_POPF},
	{"POPFD"	,INSTR86_POPFD},
	{"PUSH"	,INSTR86_PUSH		,F_NONE	,F_NONE	,F_ALL	,O_SRC},
	{"PUSHA"	,INSTR86_PUSHA},
	{"PUSHAD",INSTR86_PUSHAD},
	{"PUSHF"	,INSTR86_PUSHF},
	{"PUSHFD",INSTR86_PUSHFD},
	{"RCL"	,INSTR86_RCL		,F_C		,F_C		,F_NONE	,O_MDST},
	{"RCR"	,INSTR86_RCR		,F_C		,F_C		,F_NONE	,O_MDST},
	{"ROL"	,INSTR86_ROL		,F_C		,F_NONE	,F_NONE	,O_MDST},
	{"ROR"	,INSTR86_ROR		,F_C		,F_NONE	,F_NONE	,O_MDST},
	{"REP"	,INSTR86_REP},
	{"REPE"	,INSTR86_REPE},
	{"REPZ"	,INSTR86_REPZ},
	{"REPNE"	,INSTR86_REPNE},
	{"REPNZ"	,INSTR86_REPNZ},
	{"RET"	,INSTR86_RET		,F_NONE	,F_NONE	,F_NONE	,O_NONE},
	{"SAHF"	,INSTR86_SAHF},
	{"SAL"	,INSTR86_SAL		,F_ALL	,F_NONE	,F_NONE	,O_MDST},
	{"SAR"	,INSTR86_SAR		,F_ALL	,F_NONE	,F_NONE	,O_MDST},
	{"SHL"	,INSTR86_SHL		,F_ALL	,F_NONE	,F_NONE	,O_MDST},
	{"SHR"	,INSTR86_SHR		,F_ALL	,F_NONE	,F_NONE	,O_MDST},
	{"SBB"	,INSTR86_SBB		,F_ALL	,F_C		,F_NONE	,O_MDST},
	{"SCAS"	,INSTR86_SCAS},
	{"SCASB"	,INSTR86_SCASB},
	{"SCASW"	,INSTR86_SCASW},
	{"SCASD"	,INSTR86_SCASD},
	{"SETA"	,INSTR86_SETA},
	{"SETAE"	,INSTR86_SETAE},
	{"SETB"	,INSTR86_SETB},
	{"SETBE"	,INSTR86_SETBE},
	{"SETC"	,INSTR86_SETC},
	{"SETE"	,INSTR86_SETE},
	{"SETG"	,INSTR86_SETG},
	{"SETGE"	,INSTR86_SETGE},
	{"SETL"	,INSTR86_SETL},
	{"SETLE"	,INSTR86_SETLE},
	{"SETNA"	,INSTR86_SETNA},
	{"SETNAE",INSTR86_SETNAE},
	{"SETNB"	,INSTR86_SETNB},
	{"SETNBE",INSTR86_SETNBE},
	{"SETNC"	,INSTR86_SETNC},
	{"SETNE"	,INSTR86_SETNE		,F_NONE	,F_NE		,F_ALL	,O_MOD},
	{"SETNG"	,INSTR86_SETNG},
	{"SETNGE",INSTR86_SETNGE},
	{"SETNL"	,INSTR86_SETNL},
	{"SETNLE",INSTR86_SETNLE},
	{"SETNO"	,INSTR86_SETNO},
	{"SETNP"	,INSTR86_SETNP},
	{"SETNS"	,INSTR86_SETNS},
	{"SETNZ"	,INSTR86_SETNZ},
	{"SETO"	,INSTR86_SETO},
	{"SETP"	,INSTR86_SETP},
	{"SETPE"	,INSTR86_SETPE},
	{"SETPO"	,INSTR86_SETPO},
	{"SETS"	,INSTR86_SETS},
	{"SETZ"	,INSTR86_SETZ},
	{"SGDT"	,INSTR86_SGDT},
	{"SIDT"	,INSTR86_SIDT},
	{"SHLD"	,INSTR86_SHLD},
	{"SHRD"	,INSTR86_SHRD},
	{"SLDT"	,INSTR86_SLDT},
	{"SMSW"	,INSTR86_SMSW},
	{"STC"	,INSTR86_STC},
	{"STD"	,INSTR86_STD},
	{"STI"	,INSTR86_STI},
	{"STOS"	,INSTR86_STOS},
	{"STOSB"	,INSTR86_STOSB},
	{"STOSW"	,INSTR86_STOSW},
	{"STOSD"	,INSTR86_STOSD},
	{"STR"	,INSTR86_STR},
	{"SUB"	,INSTR86_SUB		,F_ALL	,F_NONE	,F_NONE	,O_MDST},
	{"TEST"	,INSTR86_TEST		,F_ALL	,F_NONE	,F_NONE	,O_SRC},
	{"VERR"	,INSTR86_VERR},
	{"VERW"	,INSTR86_VERW},
	{"WAIT"	,INSTR86_WAIT},
	{"XCHG"	,INSTR86_XCHG},
	{"XLAT"	,INSTR86_XLAT},
	{"XLATB"	,INSTR86_XLATB},
	{"XOR"	,INSTR86_XOR},
/* Makron */
	{"CLR"	,INSTR86_CLR		,F_NONE	,F_NONE	,F_NONE	,O_DST},
	{"%%%%"	,INSTR86_MACRO_USE,F_NONE	,F_NONE	,F_NONE	,O_MACRO},
	{"RTKF"	,INSTR86_RTKF		,F_NONE	,F_SUBSET,F_NONE	,O_NONE},
/* Interna instruktioner */
	{"%ABCD%",INSTR86_INT_ABCD	,F_C		,F_C		,F_NONE	,O_MDST},
	{"%SBCD%",INSTR86_INT_SBCD	,F_C		,F_C		,F_NONE	,O_MDST},
/* Data direktiv */
	{"DB"		,INSTR86_DB			,F_NONE	,F_NONE	,F_NONE	,O_DATA},
	{"DW"		,INSTR86_DW			,F_NONE	,F_NONE	,F_NONE	,O_DATA},
	{"DD"		,INSTR86_DD			,F_NONE	,F_NONE	,F_NONE	,O_DATA},
	{"EQU"	,INSTR86_EQU		,F_NONE	,F_NONE	,F_NONE	,O_DATA},
	{"RSTRUCB",INSTR86_RSTRUCB,F_NONE,F_NONE,F_NONE,O_DATA},
	{"RSTRUCW",INSTR86_RSTRUCW,F_NONE,F_NONE,F_NONE,O_DATA},
	{"RSTRUCD",INSTR86_RSTRUCD,F_NONE,F_NONE,F_NONE,O_DATA},
	{"RSTRUCSET",INSTR86_RSTRUCSET,F_NONE,F_NONE	,F_NONE	,O_MACRO},
	{"RSTRUCRESET",INSTR86_RSTRUCRESET,F_NONE,F_NONE,F_NONE,O_NONE},

/* TASM direktiv */
	{"IF"		,INSTR86_IF			,F_NONE	,F_NONE	,F_NONE	,O_DATA},
	{"ENDIF"	,INSTR86_ENDIF		,F_NONE	,F_NONE	,F_NONE	,O_NONE},
	{"REPT"	,INSTR86_REPT		,F_NONE	,F_NONE	,F_NONE	,O_DATA},
	{"ENDM"	,INSTR86_ENDM		,F_NONE	,F_NONE	,F_NONE	,O_NONE},
	{"INCLUDE",INSTR86_INCLUDE	,F_NONE	,F_NONE	,F_NONE	,O_SPECIAL},
	{"="		,INSTR86_SET		,F_NONE	,F_NONE	,F_NONE	,O_DATA},
	{"DUP"	,INSTR86_DUP},
	{""		,INSTR86_UNKNOWN}
};


INFO86 *info386(INSTRCODE86 instr)
{
	INFO86 *ptr;
	for(ptr=table;ptr->instr!=INSTR86_UNKNOWN;ptr++)
		if(ptr->instr==instr)
			return ptr;
	return NULL;
}
